global
    log stdout format raw local0
    maxconn 2000
    daemon

defaults
    log global
    mode http
    option httplog
    option dontlognull
    timeout connect 5000
    timeout client 50000
    timeout server 50000

frontend http_in
    bind *:80
    default_backend web_backends

backend web_backends
    balance roundrobin
    option httpchk GET /
    server web_1 web:80 check
    # Swarm DNS resolver automáticamente balancea entre réplicas
    # No necesita listar todas las réplicas manualmente
    # HAProxy con DNS resolver:
    # resolvers docker resolve-prefer ipv4
    # server-template web 3 web:80 check resolvers docker init-addr none

listen stats
    bind *:8404
    mode http
    stats enable
    stats uri /stats
    stats refresh 5s
    stats auth admin:admin123
